<html>
<body style="margin:0;">    
    <canvas style="display:block; margin: 0 auto; border-radius: 50%;" id="canvas"></canvas>    

    {{#externalnft#}}

    <script>
        function cs(e, t, r) { var a = e.createShader(t); if (e.shaderSource(a, r), e.compileShader(a), e.getShaderParameter(a, e.COMPILE_STATUS)) return a; e.deleteShader(a) } function cp(e, t, r) { var a = e.createProgram(); if (e.attachShader(a, t), e.attachShader(a, r), e.linkProgram(a), e.getProgramParameter(a, e.LINK_STATUS)) return a; e.deleteProgram(a) }

        function main() {
            var canvas = document.querySelector("#canvas");
            var webGL = document.createElement("canvas");
            const b = document.body;
            var ctx = canvas.getContext("2d");
            const gl = webGL.getContext("webgl");
            const vs = `
                attribute vec4 a_position;

                void main() {
                  gl_Position = a_position;
                }
              `;

const fs = `
precision highp float;

uniform vec2 iResolution;
uniform float iTime;
uniform vec4 iDate;

#define t iTime
#define r iResolution.xy
#define pi 3.1415

int mod(int x, int y)
{
    float f = float(x)/float(y);
    return x - y * int(floor(f));
}

float line(vec2 lP, vec2 lA, vec2 lB, float lr, float ls)
{
    vec2 g = lB - lA;
    vec2 h = lP - lA;
    float d = length(h - g * clamp(dot(g, h) / dot(g,g), 0.0, 1.0));
	return smoothstep(lr, ls*lr, d);
}

{{#hands#}}

{{#background#}}

    void main() {
        mainImage(gl_FragColor, gl_FragCoord.xy);
    }
`;

        var vertexShader = cs(gl, gl.VERTEX_SHADER, vs);
        var fragmentShader = cs(gl, gl.FRAGMENT_SHADER, fs);
        const program = cp(gl, vertexShader, fragmentShader);
        const positionAttributeLocation = gl.getAttribLocation(program, "a_position");
        const resolutionLocation = gl.getUniformLocation(program, "iResolution");        
        const timeLocation = gl.getUniformLocation(program, "iTime");
        const dateLocation = gl.getUniformLocation(program, "iDate");
        const positionBuffer = gl.createBuffer();
        gl.bindBuffer(gl.ARRAY_BUFFER, positionBuffer);
        gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([
            -1, -1,
            1, -1,
            -1, 1,
            -1, 1,
            1, -1,
            1, 1,
        ]), gl.STATIC_DRAW);
        let requestId;
        function rf() {
            if (!requestId) {
                requestId = requestAnimationFrame(render);
            }
        }
        function cf() {
            if (requestId) {
                cancelAnimationFrame(requestId);
                requestId = undefined;
            }
        }
        setInterval(rf, 10);
        let then = 0;
        let time = 0;

        function rc() {            
            ctx.drawImage(webGL, 0, 0, canvas.width, canvas.height);

            {{#numbers#}}           
        }

        function render(now) {
            var s = (b.clientWidth < b.clientHeight ? b.clientWidth : b.clientHeight) * 0.9;
            var r = s / 2;
            canvas.style.width = s;
            canvas.style.height = s;
            canvas.width = s;
            canvas.height = s;
            webGL.width = s * 2;
            webGL.height = s * 2;

            requestId = undefined;
            now *= 0.001;
            const elapsedTime = Math.min(now - then, 0.1);
            time += elapsedTime;
            then = now;                            
            gl.viewport(0, 0, gl.canvas.width, gl.canvas.height);
            gl.useProgram(program);
            gl.enableVertexAttribArray(positionAttributeLocation);
            gl.bindBuffer(gl.ARRAY_BUFFER, positionBuffer);
            gl.vertexAttribPointer(
                positionAttributeLocation,
                2,
                gl.FLOAT,
                false,
                0,
                0,
            );
            gl.uniform2f(resolutionLocation, gl.canvas.width, gl.canvas.height);
            gl.uniform1f(timeLocation, time);
            var d = new Date();
            gl.uniform4f(dateLocation, d.getFullYear(), d.getMonth(), d.getDate(), d.getSeconds() + d.getMinutes() * 60 + d.getHours() * 60 * 60 + (d.getMilliseconds() / 1000));
            gl.drawArrays(
                gl.TRIANGLES,
                0,
                6,
            );
            rf();

            rc();            
        }
        rf();
        requestAnimationFrame(cf);
    }
    main();
    </script>
</body>
</html>